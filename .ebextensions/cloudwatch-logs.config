packages:
yum:
amazon-cloudwatch-agent: []

files:
"/opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.json":
mode: "000644"
owner: root
group: root
content: |
{
"logs": {
"logs_collected": {
"files": {
"collect_list": [
{
"file_path": "/var/log/web.stdout.log",
"log_group_name": "eb-app-stdout",
"log_stream_name": "{instance_id}"
},
{
"file_path": "/var/log/web.stderr.log",
"log_group_name": "eb-app-stderr",
"log_stream_name": "{instance_id}"
},
{
"file_path": "/var/log/nginx/error.log",
"log_group_name": "eb-nginx-error",
"log_stream_name": "{instance_id}"
},
{
"file_path": "/var/app/current/logs/app-log.txt",
"log_group_name": "eb-app-logfile",
"log_stream_name": "{instance_id}"
}
]
}
}
}
}

commands:
01-start-cloudwatch-agent:
command: "/opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-ctl -a fetch-config -m ec2 -c file:/opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.json -s"
